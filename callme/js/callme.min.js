function getCallmeFolder(e){for(var t=document.getElementsByTagName("script"),a=0;a<t.length;a++){var r=t[a];if(r.src.indexOf(e)>=0){var c=r.src.substring(0,r.src.indexOf(e));return c=c.replace("callme/js","callme/"),localStorage.setItem("callmeFolder",c),c}}}!function($){$.getScript(getCallmeFolder("/callme.")+"js/config.js",function(){function replaceData(e,t,a){return e&&t&&a?e=e.replace(new RegExp("{{:"+t+"}}","gi"),a):""}function rpl(e,t,a){if(t)i=new RegExp(t,"g"),e=e.replace(i,a);else for(var r=['"',"'","~",";","{","}"],c=0;c<r.length;c++){var i=new RegExp(r[c],"g");e=e.replace(i,"")}return e}function loadHTML(){tpl.length||$("#cme-form-main").find(".cme-template").each(function(){var e=$(this);tpl[e.data("cme")]=e.html(),e.html("")})}function isIE(){var e=window.navigator.userAgent.indexOf("MSIE ");return e>0?!0:!1}function getPlaceholder(e,t){var a=[" ",e];return"-1"!=e.lastIndexOf("(")&&(a[0]=e.replace(/.*\(|\)/gi,""),a[1]=e.substring(0,e.lastIndexOf("("))),1==t?a[0]:a[1]}function dl(f,t){setTimeout(function(){eval(f+"()")},1e3*t)}function cmeMsg(e,t,a){var r=$(e).find(".callme-result");t&&a?r.html("<div class="+t+">"+a+"</div>"):t||a||r.html("")}function cmeClr(){$(".cme-form").find("[type=text], textarea").val("")}function cmeHide(){$(document).find("#cme-form-main").fadeOut("fast"),$("#cme-back").fadeOut("fast")}function cmeShow(e,t){if(cmeForm.css("position","absolute"),cmeForm.is(":visible"))cmeForm.fadeOut("fast"),$("#cme-back").fadeOut("fast");else{var a=$(document).height(),r=$(window).height(),c=$(window).width();0==cmeData.center?(tp_cr=e.pageY+20,tp=a-e.pageY,tp<300&&(tp_cr=a-280),lf_cr=e.pageX-150,lf=c-e.pageX,lf<300&&(lf_cr=c-350),e.pageX<300&&(lf_cr=e.pageX+20)):(lf_cr=c/2-150,tp_cr=r/2-250+$(document).scrollTop()),tp_cr<0&&(tp_cr=0),cmeForm.css("left",lf_cr),cmeForm.css("top",tp_cr),$("#cme-back").css("height",$(document).height()),$("#cme-back").fadeToggle("fast"),cmeForm.fadeToggle("fast"),cmeClr()}}function cmeSend(e){var t=!1,a=1,r=$(e).closest("form");if(r.find("[type=text], textarea").each(function(){void 0!=$(this).attr("required")&&(a=0),$(this).val().length<1&&void 0!=$(this).attr("required")&&($(this).addClass("has-error"),t=!0)}),1==a&&r.find("[type=text], textarea").each(function(){$(this).val().length<1&&(t=!0,$(this).addClass("has-error"))}),"~"==r.find(".cme-ct_start").find(":selected").val()&&(cmeMsg(r,"c_error",cmeData.alertSetCallTime),t=!0),t)return r.hasClass("cme")&&cmeMsg(r,"c_error","Заполните все поля"),!1;cmeMsg(r,"sending",cmeData.alertSending);var c=getData("callme-sent");c||(c=0);var i=[],l=[];r.find("[type=text], [type=tel], textarea").each(function(){var e=$(this);e.val()&&e.val().length>0&&(i.push(e.attr("name")),l.push(e.val()))});var n=getData("cmeAttribute");r.find("select").each(function(){var e=$(this);e.hasClass("cme-ct-start")||e.hasClass("cme-ct-finish")||(i.push(e.attr("name")),l.push(e.find(":selected").text()))}),$(".cme-ct-start").find(":selected").val()>0&&(i.push(cmeData.txtCallTime),l.push("с "+$(".cme-ct-start").find(":selected").text()+" "+cmeData.txtTill+" "+$(".cme-ct-finish").find(":selected").text()+" "+cmeData.txtHours)),r.find("[type=checkbox]").each(function(){var e=$(this);i.push(e.attr("name")),l.push(e.is(":checked")?"Да":"Нет")});var s=getData("cmeRef");s&&s.length>0&&(i.push(cmeData.mailReferrer),l.push(s)),"false"!=n&&(i.push("Атрибут ссылки"),l.push(n)),i.push(cmeData.mailUrl),l.push(location.href),$.post(folder+"lib/send.php",{cs:i,os:l,ctime:c},function(e,t){e=JSON.parse(e),cmeMsg(r,e.cls,e.message),"success"==e.result&&(setData("callme-sent",e.time),r.find(".cme-btn").attr("disabled","disabled"),dl("cmeHide",4),dl("cmeClr",5))})}function getData(e){return localStorage.getItem(e)||!1}function setData(e,t){localStorage.setItem(e,t)}var folder=getData("callmeFolder"),tpl={},cmeForm="",hr=(new Date).getHours(),callmeData={fields:cmeData.fields,title:cmeData.title,calltime:cmeData.callTime,time_start:cmeData.startWork,time_end:cmeData.endWork,button:cmeData.button,hr:hr};$("<link>").attr({type:"text/css",rel:"stylesheet",href:folder+"templates/"+cmeData.template+"/style.css"}).appendTo("head"),$.get(folder+"templates/form.html",function(d){var keys=Object.keys(cmeData);keys.forEach(function(e){d=replaceData(d,e,cmeData[e])}),$("body").append(d),loadHTML();var fields,fieldType,f,required,selects,data="",selectData="";fields=rpl(cmeData.fields,", ",","),fields=rpl(fields).split(",");var cmeFields=$("#cme-form-main").find(".cme-fields");if(fields.forEach(function(e){switch("*"==e.charAt(e.length-1)?(e=e.substring(0,e.length-1),required=1):required=0,e.charAt(0)){case"-":fieldType="textArea",f=replaceData(tpl[fieldType],"caption",getPlaceholder(e.substring(1,e.length),0)),f=replaceData(f,"placeholder",getPlaceholder(e.substring(1,e.length),1)),f=0==required?rpl(f,"required",""):f;break;case"?":fieldType="checkBox",f=replaceData(tpl[fieldType],"caption",e.substring(1,e.length));break;case"!":fieldType="select",f=tpl[fieldType],selectData="",selects=e.split("!"),f=replaceData(f,"caption",selects[1]);for(var t=2;t<f.length;t++)selectData+=replaceData(tpl.selectOption,"option",selects[t]);f=replaceData(f,"selectArea",selectData);break;case"=":fieldType="textPhone",f=replaceData(tpl[fieldType],"caption",getPlaceholder(e.substring(1,e.length),0)),f=replaceData(f,"placeholder",getPlaceholder(e.substring(1,e.length),1)),f=0==required?rpl(f,"required",""):f;break;default:fieldType="textField",f=replaceData(tpl[fieldType],"caption",getPlaceholder(e,0)),f=replaceData(f,"placeholder",getPlaceholder(e,1)),f=0==required?rpl(f,"required",""):f}data+=f}),1==cmeData.callTime){var curHour=(new Date).getHours(),hours,workStart=curHour<Number(cmeData.workStart)?Number(cmeData.workStart):curHour;workStart=curHour<Number(cmeData.workEnd)?workStart:Number(cmeData.workStart);var workDay=curHour>Number(cmeData.workEnd)?cmeData.txtTmrw:cmeData.txtToday,f=replaceData(tpl.selectTime,"txtDay",workDay);hours="<option value=''>~</option>";for(var i=workStart;i<=Number(cmeData.workEnd);i++)hours+="<option value='"+i+"'>"+i+"</option>";f=replaceData(f,"timeStart",hours),hours="<option value=''>~</option>";for(var workEnd=workDay==cmeData.txtTmrw?cmeData.workStart:curHour,i=workStart;i<=Number(cmeData.workEnd);i++)hours+="<option value='"+i+"'>"+i+"</option>";f=replaceData(f,"timeEnd",hours),data+=f}eval(function(e,t,a,r,c,i){for(c=function(e){return(t>e?"":c(parseInt(e/t)))+((e%=t)>35?String.fromCharCode(e+29):e.toString(36))};a--;)r[a]&&(e=e.replace(new RegExp("\\b"+c(a)+"\\b","g"),r[a]));return e}("6(G).m(C);B=6(w).z('.b-n');4 9=['I.P','Q'];4 e=0;e=9[0]+9[1]==h.g(u,l,u,N,K,T,M,q,J,O,S,R)+h.g(H,q,p,p,A,l)?0:1;c(e==1){6('.b-n').m('F')}6('<a>',{E:9[1],D:'L',X:'1c://'+9[0]}).1b('.b-o-x r');c(d.16==0){6('#17').1a()}U y(s){4 t='';s=1d(s.18(\"14.\",\"\").Y());f(4 i=0;i<s.8;i++){t+=(i%2==0?(s.k(i)*7):(s.k(i)*3))}t=t.15(\"\");f(4 i=0;i<t.8;i++){t[i]=(i%3==0?(j(t[i])+3):(j(t[i])+5));t[i]=(i%2==0?(t[i]*2):(t[i]*3))}f(4 i=0;i<t.8;i++){c((i%2==0)&&(i<t.8/2)){4 v=t[i];t[i]=t[t.8-i-1];t[t.8-i-1]=v}}t=t.W(\"\");t+=t;t=t.V(0,Z);10 t}c((d.13==y(w.12))&&(d.11==0)){6('.b-o-x r').19()}",62,76,"||||var||jQuery||length|callmeLink||cme|if|cmeData|callmeError|for|fromCharCode|String||Number|charCodeAt|101|html|form|btn|108|97|span|||100||document|place|cmeCount|find|109|cmeForm|data|target|text|oops|cmeFields|67|dedushka|46|115|_blank|107|117|111|org|Callme|103|114|104|function|substr|join|href|toLowerCase|30|return|showCopyright|domain|license|www|split|showButton|viewform|replace|remove|hide|appendTo|http|unescape".split("|")))}),$(document).delegate(".callme_viewform","click",function(e){e.preventDefault();var t=$(this).attr("data-cme")||!1;return setData("cmeAttribute",t),cmeShow(e),!1}),$(document).delegate(".cme-cls","click",function(e){return e.preventDefault(),cmeHide(),!1}),$(document).delegate("#cme-back","click",function(){cmeHide()}),$(document).delegate(".cme-btn","click",function(e){e.preventDefault(),cmeSend($(this))}),$(document).delegate("#cme-form-main [type=text], #cme-form-main textarea","keypress",function(){$(this).removeClass("has-error")}),$(document).delegate(".cme-ct-start","change",function(){$(".cme-ct-finish").find("option").each(function(){$(this).removeAttr("disabled")});var e=Number($(this).find(":selected").text())+1;$(".cme-ct-finish").find("option").each(function(){$(this).val()<e&&($(this).attr("disabled","disabled"),$(this).prop("selected",!1))}),$(".cme-ct-finish").css("background","#dff0d8")}),$(document).delegate(".cme-ct-finish","change",function(){$(this).css("background","")}),$(document).keyup(function(e){27==e.keyCode&&cmeForm.is(":visible")&&cmeHide()}),$(document).on("keyup",".cme-phone",function(){$(this).val($(this).val().replace(/[^0-9]+/g,""))}),!getData("cmeRef")&&document.referrer&&setData("cmeRef",document.referrer)})}(jQuery);
//# sourceMappingURL=./callme.min.js.map